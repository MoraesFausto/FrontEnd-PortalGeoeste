{"ast":null,"code":"import _regeneratorRuntime from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import api from\"../services/api\";import{Loading}from\"../components/Loading/Loading\";import{NotFound}from\"../components/NotFound/NotFound\";import Download from\"../components/Button/DownloadFile\";import{useFetch}from\"./useFetching\";import{StaticMaps}from\"../pages/StaticMaps\";import{Graphic}from\"../components/Graphic/Graphic\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function GetMap(args){var _args$user;var _useFetch=useFetch('/api/Data/mapas/'+args.id),map=_useFetch.data;var url='/api/Data/mapas/resource/'+args.id;var parameters={id:args.id,token:args===null||args===void 0?void 0:(_args$user=args.user)===null||_args$user===void 0?void 0:_args$user.token,pos:'15',lef:'47'};if((map===null||map===void 0?void 0:map.static)===true){parameters.pos='25';parameters.lef='8';return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:map===null||map===void 0?void 0:map.map_desc}),/*#__PURE__*/_jsx(StaticMaps,{info:map===null||map===void 0?void 0:map.map_id}),/*#__PURE__*/_jsx(Download,_objectSpread({},parameters)),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"br\",{})})]});}else{var Data=function Data(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),err=_useState6[0],setErr=_useState6[1];var componentMounted=useRef(true);useEffect(function(){var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return api.get(url);case 4:res=_context.sent;if(componentMounted.current){json=res.data;setData(json);setLoading(false);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setErr(true);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getData(){return _ref.apply(this,arguments);};}();getData();return function(){componentMounted.current=false;};},[]);if(err){if(loading)setLoading(false);return/*#__PURE__*/_jsx(NotFound,{});}if(data){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:map===null||map===void 0?void 0:map.map_desc}),/*#__PURE__*/_jsx(Graphic,{data:data,graphic:map,downloadProps:parameters,edit:args.edit})]});}else{return/*#__PURE__*/_jsx(Loading,{});}};return/*#__PURE__*/_jsx(Data,{});}}export default GetMap;","map":{"version":3,"names":["React","useState","useEffect","useRef","api","Loading","NotFound","Download","useFetch","StaticMaps","Graphic","GetMap","args","id","map","data","url","parameters","token","user","pos","lef","static","map_desc","map_id","Data","setData","loading","setLoading","err","setErr","componentMounted","getData","get","res","current","json","edit"],"sources":["/home/f4ustx/cnpq/Portal_Geoeste/client/src/hooks/getMap.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport  api  from \"../services/api\";\nimport { Loading } from \"../components/Loading/Loading\";\nimport { NotFound } from \"../components/NotFound/NotFound\";\nimport Download from \"../components/Button/DownloadFile\";\nimport { useFetch } from \"./useFetching\";\nimport { Map } from \"../types\";\nimport { StaticMaps } from \"../pages/StaticMaps\";\nimport { Graphic } from \"../components/Graphic/Graphic\";\nimport { UserProps } from \"../interfaces\";\n\n\n\nfunction GetMap( args : UserProps) {\n\n  const {data:map} = useFetch<Map>('/api/Data/mapas/'+args.id);\n  const url = '/api/Data/mapas/resource/'+args.id;\n\n  const parameters = {\n    id: args.id,\n    token: args?.user?.token,\n    pos: '15',\n    lef: '47'\n  }\n\n  if(map?.static === true){\n    parameters.pos = '25';\n    parameters.lef = '8';\n    return(\n      <div>\n        <h2>{map?.map_desc}</h2>\n        <StaticMaps info={map?.map_id}/>\n        <Download {...parameters}/>\n        <div>\n          <br></br>\n        </div>\n      </div>\n\n    )\n  }else{\n\n    const Data: React.FC = () => {\n      const [data, setData] = useState();\n      const [loading, setLoading] = useState(false);\n      const [err, setErr] = useState(false);\n      const componentMounted = useRef(true);\n\n      useEffect(() => {\n        const getData = async () => {\n          try{\n            setLoading(true);\n            const res = await api.get(url);\n            if(componentMounted.current){\n              let json = res.data\n              setData(json);\n              setLoading(false);\n            }\n        }catch(Err){\n          setErr(true);\n        }\n        };\n        getData();\n        return () =>{\n            componentMounted.current = false;\n        }\n      },[]);\n\n      if(err){\n        if(loading) setLoading(false);\n        return <NotFound/>;\n      }\n\n      if (data) {\n        return (\n          <div>\n            <h2>{map?.map_desc}</h2>\n\n            <Graphic data={data} graphic={map} downloadProps={parameters} edit={args.edit}/>  \n          </div>    \n        );\n      } else {\n        return (\n          <Loading/>\n        )\n      }\n    };\n    return (\n      <Data />\n    );\n  }\n}\nexport default GetMap\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}