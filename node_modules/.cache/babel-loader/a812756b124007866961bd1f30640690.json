{"ast":null,"code":"import _regeneratorRuntime from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import api from\"../services/api\";import{Loading}from\"../components/Loading/Loading\";import{NotFound}from\"../components/NotFound/NotFound\";import Download from\"../components/Button/DownloadFile\";import{useFetch}from\"./useFetching\";import{StaticMaps}from\"../pages/StaticMaps\";import{Graphic}from\"../components/Graphic/Graphic\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function GetMap(_ref){var id=_ref.prop;var _useFetch=useFetch('/api/Data/mapas/'+id),map=_useFetch.data;var url='/api/Data/mapas/resource/'+id;if((map===null||map===void 0?void 0:map.choropleth)===1){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:map===null||map===void 0?void 0:map.map_desc}),/*#__PURE__*/_jsx(StaticMaps,{info:map===null||map===void 0?void 0:map.map_id}),/*#__PURE__*/_jsx(Download,{param:map===null||map===void 0?void 0:map.map_id,p:'50',l:'8'})]});}else{var Data=function Data(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),err=_useState6[0],setErr=_useState6[1];var componentMounted=useRef(true);useEffect(function(){var getData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return api.get(url);case 4:res=_context.sent;if(componentMounted.current){json=res.data;setData(json);setLoading(false);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setErr(true);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getData(){return _ref2.apply(this,arguments);};}();getData();return function(){componentMounted.current=false;};},[]);if(err){if(loading)setLoading(false);return/*#__PURE__*/_jsx(NotFound,{});}if(data){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:map===null||map===void 0?void 0:map.map_desc}),/*#__PURE__*/_jsx(Graphic,{data:data,graphic:map})]});}else{return/*#__PURE__*/_jsx(Loading,{});}};return/*#__PURE__*/_jsx(Data,{});}}export default GetMap;","map":{"version":3,"names":["React","useState","useEffect","useRef","api","Loading","NotFound","Download","useFetch","StaticMaps","Graphic","GetMap","id","prop","map","data","url","choropleth","map_desc","map_id","Data","setData","loading","setLoading","err","setErr","componentMounted","getData","get","res","current","json"],"sources":["/home/f4ustx/cnpq/Portal_Geoeste/client/src/hooks/getMap.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport  api  from \"../services/api\";\nimport { Loading } from \"../components/Loading/Loading\";\nimport { NotFound } from \"../components/NotFound/NotFound\";\nimport Download from \"../components/Button/DownloadFile\";\nimport { useFetch } from \"./useFetching\";\nimport { Map } from \"../types\";\nimport { StaticMaps } from \"../pages/StaticMaps\";\nimport { Graphic } from \"../components/Graphic/Graphic\";\n\nfunction GetMap({ prop:id }) {\n\n  const {data:map} = useFetch<Map>('/api/Data/mapas/'+id);\n  const url = '/api/Data/mapas/resource/'+id;\n\n  if(map?.choropleth === 1){\n    return(\n      <div>\n        <h2>{map?.map_desc}</h2>\n        <StaticMaps info={map?.map_id}/>\n        <Download param={map?.map_id} p={'50'} l={'8'}/>\n      </div>\n\n    )\n  }else{\n\n    const Data: React.FC = () => {\n      const [data, setData] = useState();\n      const [loading, setLoading] = useState(false);\n      const [err, setErr] = useState(false);\n      const componentMounted = useRef(true);\n\n      useEffect(() => {\n        const getData = async () => {\n          try{\n            setLoading(true);\n            const res = await api.get(url);\n            if(componentMounted.current){\n              let json = res.data\n              setData(json);\n              setLoading(false);\n            }\n        }catch(Err){\n          setErr(true);\n        }\n        };\n        getData();\n        return () =>{\n            componentMounted.current = false;\n        }\n      },[]);\n\n      if(err){\n        if(loading) setLoading(false);\n        return <NotFound/>;\n      }\n\n      if (data) {\n        return (\n          <div>\n            <h2>{map?.map_desc}</h2>\n\n            <Graphic data={data} graphic={map}/>  \n          </div>    \n        );\n      } else {\n        return (\n          <Loading/>\n        )\n      }\n    };\n    return (\n      <Data />\n    );\n  }\n}\nexport default GetMap\n"],"mappings":"uYAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,MAAQC,IAAR,KAAkB,iBAAlB,CACA,OAASC,OAAT,KAAwB,+BAAxB,CACA,OAASC,QAAT,KAAyB,iCAAzB,CACA,MAAOC,SAAP,KAAqB,mCAArB,CACA,OAASC,QAAT,KAAyB,eAAzB,CAEA,OAASC,UAAT,KAA2B,qBAA3B,CACA,OAASC,OAAT,KAAwB,+BAAxB,C,wFAEA,QAASC,OAAT,MAA6B,IAANC,GAAM,MAAXC,IAAW,CAE3B,cAAmBL,QAAQ,CAAM,mBAAmBI,EAAzB,CAA3B,CAAYE,GAAZ,WAAOC,IAAP,CACA,GAAMC,IAAG,CAAG,4BAA4BJ,EAAxC,CAEA,GAAG,CAAAE,GAAG,OAAH,EAAAA,GAAG,SAAH,QAAAA,GAAG,CAAEG,UAAL,IAAoB,CAAvB,CAAyB,CACvB,mBACE,oCACE,oBAAKH,GAAL,SAAKA,GAAL,iBAAKA,GAAG,CAAEI,QAAV,EADF,cAEE,KAAC,UAAD,EAAY,IAAI,CAAEJ,GAAF,SAAEA,GAAF,iBAAEA,GAAG,CAAEK,MAAvB,EAFF,cAGE,KAAC,QAAD,EAAU,KAAK,CAAEL,GAAF,SAAEA,GAAF,iBAAEA,GAAG,CAAEK,MAAtB,CAA8B,CAAC,CAAE,IAAjC,CAAuC,CAAC,CAAE,GAA1C,EAHF,GADF,CAQD,CATD,IASK,CAEH,GAAMC,KAAc,CAAG,QAAjBA,KAAiB,EAAM,CAC3B,cAAwBnB,QAAQ,EAAhC,wCAAOc,IAAP,eAAaM,OAAb,eACA,eAA8BpB,QAAQ,CAAC,KAAD,CAAtC,yCAAOqB,OAAP,eAAgBC,UAAhB,eACA,eAAsBtB,QAAQ,CAAC,KAAD,CAA9B,yCAAOuB,GAAP,eAAYC,MAAZ,eACA,GAAMC,iBAAgB,CAAGvB,MAAM,CAAC,IAAD,CAA/B,CAEAD,SAAS,CAAC,UAAM,CACd,GAAMyB,QAAO,6FAAG,kKAEZJ,UAAU,CAAC,IAAD,CAAV,CAFY,sBAGMnB,IAAG,CAACwB,GAAJ,CAAQZ,GAAR,CAHN,QAGNa,GAHM,eAIZ,GAAGH,gBAAgB,CAACI,OAApB,CAA4B,CACtBC,IADsB,CACfF,GAAG,CAACd,IADW,CAE1BM,OAAO,CAACU,IAAD,CAAP,CACAR,UAAU,CAAC,KAAD,CAAV,CACD,CARW,+EAUdE,MAAM,CAAC,IAAD,CAAN,CAVc,oEAAH,kBAAPE,QAAO,2CAAb,CAaAA,OAAO,GACP,MAAO,WAAK,CACRD,gBAAgB,CAACI,OAAjB,CAA2B,KAA3B,CACH,CAFD,CAGD,CAlBQ,CAkBP,EAlBO,CAAT,CAoBA,GAAGN,GAAH,CAAO,CACL,GAAGF,OAAH,CAAYC,UAAU,CAAC,KAAD,CAAV,CACZ,mBAAO,KAAC,QAAD,IAAP,CACD,CAED,GAAIR,IAAJ,CAAU,CACR,mBACE,oCACE,oBAAKD,GAAL,SAAKA,GAAL,iBAAKA,GAAG,CAAEI,QAAV,EADF,cAGE,KAAC,OAAD,EAAS,IAAI,CAAEH,IAAf,CAAqB,OAAO,CAAED,GAA9B,EAHF,GADF,CAOD,CARD,IAQO,CACL,mBACE,KAAC,OAAD,IADF,CAGD,CACF,CA5CD,CA6CA,mBACE,KAAC,IAAD,IADF,CAGD,CACF,CACD,cAAeH,OAAf"},"metadata":{},"sourceType":"module"}