{"ast":null,"code":"var _jsxFileName = \"/home/f4ustx/cnpq/Portal_Geoeste/client/src/components/Button/DownloadFile.tsx\";\nimport axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { DateTime } from \"luxon\";\nimport { useDownload } from \"../../hooks/useDownload\";\nimport { Button, ButtonState } from \"./Button\";\nimport { Alert, Container } from \"react-bootstrap\";\nimport { DownloadBtn } from \"./style\";\nimport { Navigate } from \"react-router-dom\";\nimport { Auth } from \"../../hooks/useAuth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Download(_ref) {\n  var _s = $RefreshSig$();\n\n  let {\n    param: id,\n    p: pos,\n    l: lef\n  } = _ref;\n  const path = \"/api/Data/mapas/\" + String(id) + \"/download\";\n  const {\n    user,\n    err,\n    check\n  } = Auth('api/perfil');\n\n  const DownloadFile = () => {\n    _s();\n\n    const [buttonState, setButtonState] = useState(ButtonState.Primary);\n    const [showAlert, setShowAlert] = useState(false);\n\n    const preDownloading = () => setButtonState(ButtonState.Loading);\n\n    const postDownloading = () => setButtonState(ButtonState.Primary);\n\n    const onErrorDownloadFile = () => {\n      setButtonState(ButtonState.Primary);\n      setShowAlert(true);\n      setTimeout(() => {\n        setShowAlert(false);\n      }, 3000);\n    };\n\n    const getFileName = () => {\n      return DateTime.local().toISODate() + String(id) + \".zip\";\n    };\n\n    const downloadFile = () => {\n      // throw new Error(\"uncomment this line to mock failure of API\");\n      return axios.get(path, {\n        responseType: \"blob\",\n        headers: {\n          authorization: \"Bearer <token>\" // add authentication information as required by the backend APIs.\n\n        }\n      });\n    };\n\n    const {\n      ref,\n      url,\n      download,\n      name\n    } = useDownload({\n      apiDefinition: downloadFile,\n      preDownloading,\n      postDownloading,\n      onError: onErrorDownloadFile,\n      getFileName\n    });\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-5\",\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        show: showAlert,\n        children: /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(DownloadBtn, {\n        p: pos,\n        l: lef,\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: url,\n          download: name,\n          className: \"hidden\",\n          ref: ref\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            label: \"Download\",\n            buttonState: buttonState,\n            onClick: download\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }, this);\n  };\n\n  _s(DownloadFile, \"3ND9IFmlV+NH1firqCg+IpSt5Ag=\", false, function () {\n    return [useDownload];\n  });\n\n  return /*#__PURE__*/_jsxDEV(DownloadFile, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n\n_c = Download;\n;\nexport default Download;\n\nvar _c;\n\n$RefreshReg$(_c, \"Download\");","map":{"version":3,"names":["axios","React","useState","DateTime","useDownload","Button","ButtonState","Alert","Container","DownloadBtn","Navigate","Auth","Download","param","id","p","pos","l","lef","path","String","user","err","check","DownloadFile","buttonState","setButtonState","Primary","showAlert","setShowAlert","preDownloading","Loading","postDownloading","onErrorDownloadFile","setTimeout","getFileName","local","toISODate","downloadFile","get","responseType","headers","authorization","ref","url","download","name","apiDefinition","onError"],"sources":["/home/f4ustx/cnpq/Portal_Geoeste/client/src/components/Button/DownloadFile.tsx"],"sourcesContent":["import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { DateTime } from \"luxon\";\nimport { useDownload } from \"../../hooks/useDownload\";\nimport { Button, ButtonState } from \"./Button\";\nimport { Alert, Container } from \"react-bootstrap\";\nimport { DownloadBtn } from \"./style\";\nimport { Navigate } from \"react-router-dom\";\nimport { Auth } from \"../../hooks/useAuth\";\nimport { User } from \"../../interfaces\";\n\nfunction Download({param:id, p:pos, l:lef}) {\n  const path = \"/api/Data/mapas/\"+ String(id) + \"/download\"\n  const { user, err, check } = Auth<User | null>('api/perfil');\n\n  const DownloadFile: React.FC = () => {\n  const [buttonState, setButtonState] = useState<ButtonState>(\n    ButtonState.Primary\n  );\n  const [showAlert, setShowAlert] = useState<boolean>(false);\n\n  const preDownloading = () => setButtonState(ButtonState.Loading);\n  const postDownloading = () => setButtonState(ButtonState.Primary);\n\n  const onErrorDownloadFile = () => {\n    setButtonState(ButtonState.Primary);\n    setShowAlert(true);\n    setTimeout(() => {\n      setShowAlert(false);\n    }, 3000);\n  };\n\n  const getFileName = () => {\n    return DateTime.local().toISODate() + String(id) + \".zip\";\n  };\n\n  const downloadFile = () => {\n    // throw new Error(\"uncomment this line to mock failure of API\");\n    return axios.get(\n      path,\n      {\n        responseType: \"blob\",\n         \n        headers: {\n          authorization: \"Bearer <token>\", // add authentication information as required by the backend APIs.\n        }\n         \n      }\n    );\n  };\n\n  const { ref, url, download, name } = useDownload({\n    apiDefinition: downloadFile,\n    preDownloading,\n    postDownloading,\n    onError: onErrorDownloadFile,\n    getFileName,\n  });\n\n  return (\n    <Container className=\"mt-5\">\n      <Alert variant=\"danger\" show={showAlert}>\n        <Navigate to='/login'/>\n      </Alert>\n      <DownloadBtn p={pos} l={lef}>\n      <a href={url} download={name} className=\"hidden\" ref={ref} />\n      <div>\n      <Button label=\"Download\" buttonState={buttonState} onClick={download}/>\n      </div>\n      </DownloadBtn>\n    </Container>\n  );\n}\nreturn (<DownloadFile/>)\n};\n\nexport default Download;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}