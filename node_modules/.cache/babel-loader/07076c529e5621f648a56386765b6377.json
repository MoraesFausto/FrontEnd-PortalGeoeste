{"ast":null,"code":"import _slicedToArray from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import React,{useState}from\"react\";import{DateTime}from\"luxon\";import{useDownload}from\"../../hooks/useDownload\";import{Button,ButtonState}from\"./Button\";import{Alert,Container}from\"react-bootstrap\";import{DownloadBtn}from\"./style\";import{Navigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Download(_ref){var id=_ref.param,pos=_ref.p,lef=_ref.l;var path=\"/api/Data/mapas/\"+String(id)+\"/download\";var DownloadFile=function DownloadFile(){var _useState=useState(ButtonState.Primary),_useState2=_slicedToArray(_useState,2),buttonState=_useState2[0],setButtonState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showAlert=_useState4[0],setShowAlert=_useState4[1];var preDownloading=function preDownloading(){return setButtonState(ButtonState.Loading);};var postDownloading=function postDownloading(){return setButtonState(ButtonState.Primary);};var onErrorDownloadFile=function onErrorDownloadFile(){setButtonState(ButtonState.Primary);setShowAlert(true);setTimeout(function(){setShowAlert(false);},3000);};var getFileName=function getFileName(){return DateTime.local().toISODate()+String(id)+\".zip\";};var downloadFile=function downloadFile(){// throw new Error(\"uncomment this line to mock failure of API\");\nreturn axios.get(path,{responseType:\"blob\"/* \n        headers: {\n          Authorization: \"Bearer <token>\", // add authentication information as required by the backend APIs.\n        },\n         */});};var _useDownload=useDownload({apiDefinition:downloadFile,preDownloading:preDownloading,postDownloading:postDownloading,onError:onErrorDownloadFile,getFileName:getFileName}),ref=_useDownload.ref,url=_useDownload.url,download=_useDownload.download,name=_useDownload.name;return/*#__PURE__*/_jsxs(Container,{className:\"mt-5\",children:[/*#__PURE__*/_jsx(Alert,{variant:\"danger\",show:showAlert,children:/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsxs(DownloadBtn,{p:pos,l:lef,children:[/*#__PURE__*/_jsx(\"a\",{href:url,download:name,className:\"hidden\",ref:ref}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{label:\"Download\",buttonState:buttonState,onClick:download})})]})]});};return/*#__PURE__*/_jsx(DownloadFile,{});};export default Download;","map":{"version":3,"names":["axios","React","useState","DateTime","useDownload","Button","ButtonState","Alert","Container","DownloadBtn","Navigate","Download","id","param","pos","p","lef","l","path","String","DownloadFile","Primary","buttonState","setButtonState","showAlert","setShowAlert","preDownloading","Loading","postDownloading","onErrorDownloadFile","setTimeout","getFileName","local","toISODate","downloadFile","get","responseType","apiDefinition","onError","ref","url","download","name"],"sources":["/home/f4ustx/cnpq/Portal_Geoeste/client/src/components/Button/DownloadFile.tsx"],"sourcesContent":["import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { DateTime } from \"luxon\";\nimport { useDownload } from \"../../hooks/useDownload\";\nimport { Button, ButtonState } from \"./Button\";\nimport { Alert, Container } from \"react-bootstrap\";\nimport { DownloadBtn } from \"./style\";\nimport { Navigate } from \"react-router-dom\";\n\nfunction Download({param:id, p:pos, l:lef}) {\n  const path = \"/api/Data/mapas/\"+ String(id) + \"/download\"\n  const DownloadFile: React.FC = () => {\n  const [buttonState, setButtonState] = useState<ButtonState>(\n    ButtonState.Primary\n  );\n  const [showAlert, setShowAlert] = useState<boolean>(false);\n\n  const preDownloading = () => setButtonState(ButtonState.Loading);\n  const postDownloading = () => setButtonState(ButtonState.Primary);\n\n  const onErrorDownloadFile = () => {\n    setButtonState(ButtonState.Primary);\n    setShowAlert(true);\n    setTimeout(() => {\n      setShowAlert(false);\n    }, 3000);\n  };\n\n  const getFileName = () => {\n    return DateTime.local().toISODate() + String(id) + \".zip\";\n  };\n\n  const downloadFile = () => {\n    // throw new Error(\"uncomment this line to mock failure of API\");\n    return axios.get(\n      path,\n      {\n        responseType: \"blob\",\n        /* \n        headers: {\n          Authorization: \"Bearer <token>\", // add authentication information as required by the backend APIs.\n        },\n         */\n      }\n    );\n  };\n\n  const { ref, url, download, name } = useDownload({\n    apiDefinition: downloadFile,\n    preDownloading,\n    postDownloading,\n    onError: onErrorDownloadFile,\n    getFileName,\n  });\n\n  return (\n    <Container className=\"mt-5\">\n      <Alert variant=\"danger\" show={showAlert}>\n        <Navigate to='/login'/>\n      </Alert>\n      <DownloadBtn p={pos} l={lef}>\n      <a href={url} download={name} className=\"hidden\" ref={ref} />\n      <div>\n      <Button label=\"Download\" buttonState={buttonState} onClick={download}/>\n      </div>\n      </DownloadBtn>\n    </Container>\n  );\n}\nreturn (<DownloadFile/>)\n};\n\nexport default Download;\n"],"mappings":"6HAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,MAAOC,MAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,QAAT,KAAyB,OAAzB,CACA,OAASC,WAAT,KAA4B,yBAA5B,CACA,OAASC,MAAT,CAAiBC,WAAjB,KAAoC,UAApC,CACA,OAASC,KAAT,CAAgBC,SAAhB,KAAiC,iBAAjC,CACA,OAASC,WAAT,KAA4B,SAA5B,CACA,OAASC,QAAT,KAAyB,kBAAzB,C,wFAEA,QAASC,SAAT,MAA4C,IAAnBC,GAAmB,MAAzBC,KAAyB,CAAbC,GAAa,MAAfC,CAAe,CAANC,GAAM,MAARC,CAAQ,CAC1C,GAAMC,KAAI,CAAG,mBAAoBC,MAAM,CAACP,EAAD,CAA1B,CAAiC,WAA9C,CACA,GAAMQ,aAAsB,CAAG,QAAzBA,aAAyB,EAAM,CACrC,cAAsClB,QAAQ,CAC5CI,WAAW,CAACe,OADgC,CAA9C,wCAAOC,WAAP,eAAoBC,cAApB,eAGA,eAAkCrB,QAAQ,CAAU,KAAV,CAA1C,yCAAOsB,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,eAAc,CAAG,QAAjBA,eAAiB,SAAMH,eAAc,CAACjB,WAAW,CAACqB,OAAb,CAApB,EAAvB,CACA,GAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,SAAML,eAAc,CAACjB,WAAW,CAACe,OAAb,CAApB,EAAxB,CAEA,GAAMQ,oBAAmB,CAAG,QAAtBA,oBAAsB,EAAM,CAChCN,cAAc,CAACjB,WAAW,CAACe,OAAb,CAAd,CACAI,YAAY,CAAC,IAAD,CAAZ,CACAK,UAAU,CAAC,UAAM,CACfL,YAAY,CAAC,KAAD,CAAZ,CACD,CAFS,CAEP,IAFO,CAAV,CAGD,CAND,CAQA,GAAMM,YAAW,CAAG,QAAdA,YAAc,EAAM,CACxB,MAAO5B,SAAQ,CAAC6B,KAAT,GAAiBC,SAAjB,GAA+Bd,MAAM,CAACP,EAAD,CAArC,CAA4C,MAAnD,CACD,CAFD,CAIA,GAAMsB,aAAY,CAAG,QAAfA,aAAe,EAAM,CACzB;AACA,MAAOlC,MAAK,CAACmC,GAAN,CACLjB,IADK,CAEL,CACEkB,YAAY,CAAE,MACd;AACR;AACA;AACA;AACA,WANM,CAFK,CAAP,CAWD,CAbD,CAeA,iBAAqChC,WAAW,CAAC,CAC/CiC,aAAa,CAAEH,YADgC,CAE/CR,cAAc,CAAdA,cAF+C,CAG/CE,eAAe,CAAfA,eAH+C,CAI/CU,OAAO,CAAET,mBAJsC,CAK/CE,WAAW,CAAXA,WAL+C,CAAD,CAAhD,CAAQQ,GAAR,cAAQA,GAAR,CAAaC,GAAb,cAAaA,GAAb,CAAkBC,QAAlB,cAAkBA,QAAlB,CAA4BC,IAA5B,cAA4BA,IAA5B,CAQA,mBACE,MAAC,SAAD,EAAW,SAAS,CAAC,MAArB,wBACE,KAAC,KAAD,EAAO,OAAO,CAAC,QAAf,CAAwB,IAAI,CAAElB,SAA9B,uBACE,KAAC,QAAD,EAAU,EAAE,CAAC,QAAb,EADF,EADF,cAIE,MAAC,WAAD,EAAa,CAAC,CAAEV,GAAhB,CAAqB,CAAC,CAAEE,GAAxB,wBACA,UAAG,IAAI,CAAEwB,GAAT,CAAc,QAAQ,CAAEE,IAAxB,CAA8B,SAAS,CAAC,QAAxC,CAAiD,GAAG,CAAEH,GAAtD,EADA,cAEA,kCACA,KAAC,MAAD,EAAQ,KAAK,CAAC,UAAd,CAAyB,WAAW,CAAEjB,WAAtC,CAAmD,OAAO,CAAEmB,QAA5D,EADA,EAFA,GAJF,GADF,CAaD,CAzDC,CA0DF,mBAAQ,KAAC,YAAD,IAAR,CACC,EAED,cAAe9B,SAAf"},"metadata":{},"sourceType":"module"}