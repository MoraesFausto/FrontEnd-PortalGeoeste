{"ast":null,"code":"import _regeneratorRuntime from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/f4ustx/cnpq/Portal_Geoeste/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState}from\"react\";export var useDownload=function useDownload(_ref){var apiDefinition=_ref.apiDefinition,preDownloading=_ref.preDownloading,postDownloading=_ref.postDownloading,onError=_ref.onError,getFileName=_ref.getFileName;var ref=useRef(null);var _useState=useState(),_useState2=_slicedToArray(_useState,2),url=_useState2[0],setFileUrl=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setFileName=_useState4[1];var download=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _ref$current,_yield$apiDefinition,data,_url;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;preDownloading();_context.next=4;return apiDefinition();case 4:_yield$apiDefinition=_context.sent;data=_yield$apiDefinition.data;_url=URL.createObjectURL(new Blob([data]));setFileUrl(_url);setFileName(getFileName());(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.click();postDownloading();URL.revokeObjectURL(_url);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);onError();case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return function download(){return _ref2.apply(this,arguments);};}();return{download:download,ref:ref,url:url,name:name};};","map":{"version":3,"names":["useRef","useState","useDownload","apiDefinition","preDownloading","postDownloading","onError","getFileName","ref","url","setFileUrl","name","setFileName","download","data","URL","createObjectURL","Blob","current","click","revokeObjectURL"],"sources":["/home/f4ustx/cnpq/Portal_Geoeste/client/src/hooks/useDownload.ts"],"sourcesContent":["import { AxiosResponse } from \"axios\";\nimport { useRef, useState } from \"react\";\n\ninterface DownloadFileProps {\n  readonly apiDefinition: () => Promise<AxiosResponse<Blob>>;\n  readonly preDownloading: () => void;\n  readonly postDownloading: () => void;\n  readonly onError: () => void;\n  readonly getFileName: () => string;\n}\n\ninterface DownloadedFileInfo {\n  readonly download: () => Promise<void>;\n  readonly ref: React.MutableRefObject<HTMLAnchorElement | null>;\n  readonly name: string | undefined;\n  readonly url: string | undefined;\n}\n\nexport const useDownload = ({\n  apiDefinition,\n  preDownloading,\n  postDownloading,\n  onError,\n  getFileName,\n}: DownloadFileProps): DownloadedFileInfo => {\n  const ref = useRef<HTMLAnchorElement | null>(null);\n  const [url, setFileUrl] = useState<string>();\n  const [name, setFileName] = useState<string>();\n\n  const download = async () => {\n    try {\n      preDownloading();\n      const { data } = await apiDefinition();\n      const url = URL.createObjectURL(new Blob([data]));\n      setFileUrl(url);\n      setFileName(getFileName());\n      ref.current?.click();\n      postDownloading();\n      URL.revokeObjectURL(url);\n    } catch (error) {\n      onError();\n    }\n  };\n\n  return { download, ref, url, name };\n};"],"mappings":"uYACA,OAASA,MAAT,CAAiBC,QAAjB,KAAiC,OAAjC,CAiBA,MAAO,IAAMC,YAAW,CAAG,QAAdA,YAAc,MAMkB,IAL3CC,cAK2C,MAL3CA,aAK2C,CAJ3CC,cAI2C,MAJ3CA,cAI2C,CAH3CC,eAG2C,MAH3CA,eAG2C,CAF3CC,OAE2C,MAF3CA,OAE2C,CAD3CC,WAC2C,MAD3CA,WAC2C,CAC3C,GAAMC,IAAG,CAAGR,MAAM,CAA2B,IAA3B,CAAlB,CACA,cAA0BC,QAAQ,EAAlC,wCAAOQ,GAAP,eAAYC,UAAZ,eACA,eAA4BT,QAAQ,EAApC,yCAAOU,IAAP,eAAaC,WAAb,eAEA,GAAMC,SAAQ,6FAAG,qMAEbT,cAAc,GAFD,sBAGUD,cAAa,EAHvB,2CAGLW,IAHK,sBAGLA,IAHK,CAIPL,IAJO,CAIDM,GAAG,CAACC,eAAJ,CAAoB,GAAIC,KAAJ,CAAS,CAACH,IAAD,CAAT,CAApB,CAJC,CAKbJ,UAAU,CAACD,IAAD,CAAV,CACAG,WAAW,CAACL,WAAW,EAAZ,CAAX,CACA,cAAAC,GAAG,CAACU,OAAJ,oDAAaC,KAAb,GACAd,eAAe,GACfU,GAAG,CAACK,eAAJ,CAAoBX,IAApB,EATa,iFAWbH,OAAO,GAXM,qEAAH,kBAARO,SAAQ,2CAAd,CAeA,MAAO,CAAEA,QAAQ,CAARA,QAAF,CAAYL,GAAG,CAAHA,GAAZ,CAAiBC,GAAG,CAAHA,GAAjB,CAAsBE,IAAI,CAAJA,IAAtB,CAAP,CACD,CA3BM"},"metadata":{},"sourceType":"module"}